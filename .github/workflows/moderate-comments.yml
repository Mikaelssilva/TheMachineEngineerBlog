name: Moderate Giscus Comments
on:
  discussion_comment:
    types: [created]

jobs:
  moderate:
    runs-on: ubuntu-latest
    steps:
      - name: Check for bad words
        uses: actions/github-script@v6
        with:
          script: |
            // Palavras proibidas (adicione as suas)
            const badWords = [
                    // Racismo
                    'macaco', 'negrinho', 'branquelo', 'judeu doente', 'cabelo de bombril', 'serviÃ§o de preto',
                    
                    // LGBTfobia
                    'veado', 'bicha', 'sapatÃ£o', 'viadinho', 'aidÃ©tico', 'frutinha', 'boiola',
                    
                    // Machismo
                    'vai lavar louÃ§a', 'lugar de mulher Ã©', 'feminazi', 'puta', 'cadÃª o sanduÃ­che',
                    
                    // Outros
                    'deficiente mental', 'retardado', 'vai se matar', 'corno', 'gordo nojento',
                    
                    // Termos disfarÃ§ados (regex)
                    'v3@d0', 'b1ch4', 'm@c4c0', /n[e3]gr[o0]/i, /[ck]retin[o0]/i];
            
            // Converte comentÃ¡rio para minÃºsculas para checagem
            const commentText = context.payload.comment.body.toLowerCase();
            
            // Verifica palavras proibidas
            if (badWords.some(word => commentText.includes(word.toLowerCase()))) {
              // Deleta o comentÃ¡rio
              await github.rest.discussions.deleteComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                discussion_number: context.payload.discussion.number,
                comment_number: context.payload.comment.number
              });
              
              // Opcional: Notifica no GitHub
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.payload.discussion.number,
                body: 'ðŸš¨ ComentÃ¡rio removido por violar as regras.'
              });
            }
